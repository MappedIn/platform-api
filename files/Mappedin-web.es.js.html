<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Mappedin-web.es.js - The Mappedin Web SDK</title>
    <meta name="description" content="An easy way to render beautiful 2D or 3D maps on your website, powered by Mappedin">
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="stylesheet" href="../assets/css/custom.css">
    <link rel="stylesheet" href="../assets/vendor/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" href="../assets/vendor/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="../assets/css/theme.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700' rel='stylesheet' type='text/css'>
    

      <style>
        body a {
          color: #ff5000;
        }
        body a:hover {
          color: #ff5000;
          opacity: 0.5;
        }
        .navbar.navbar-default .navbar-nav> li> a:focus, .navbar.navbar-default .navbar-nav> li> a:hover {
          color: #ff5000;
        }
        .navbar.navbar-default .navbar-nav> .active> a, .navbar.navbar-default .navbar-nav> .active> a:focus, .navbar.navbar-default .navbar-nav> .active> a:hover {
          color: #ff5000;
        }
        #docs-main .page-header {
          color: #ff5000;
        }
        #docs-main .page-section .nav-tabs {
          border-bottom: 1px solid #ff5000;
        }
        #docs-main .page-section .nav-tabs> li.active a {
          background: #ff5000;
          border: 1px solid #ff5000;
        }
        #sidebar li.panel .panel-body ol> li.active, #sidebar li.panel .panel-body ol> li:hover {
          background: #efefef;
        }
      </style>
</head>
<body>
    <nav class="navbar navbar-default">
      <div class="container-fluid">
        <div class="navbar-header">
              <img src="../assets/img/logo.png" alt="default">
            <span>The Mappedin Web SDK</span>
          </a>
        </div>

        <div class="collapse navbar-collapse" id="nav">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://github.com/MappedIn/platform-api" class="fa fa-github github"></a></li>
          </ul>
        </div>
      </div>
    </nav>
    <div id="main-wrapper" class="row">
        <div id="content-wrapper">
            <ol class="panel-group" id="sidebar" role="tablist" aria-multiselectable="true">
                <li class="panel panel-default">
                    <div class="panel-heading" role="tab" id="sidebar-search-heading">
                        <h4 class="panel-title">
                      <a role="button" data-toggle="collapse" href="#sidebar-search" aria-expanded="true" aria-controls="collapseOne">
                        Search
                      </a>
                    </h4>
                    </div>
                    <div id="sidebar-search" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="sidebar-search-heading">
                        <div class="panel-body">
                            <div id="api-tabview-filter">
                                <input type="search" id="api-filter" placeholder="Search...">
                            </div>
                        </div>
                    </div>
                </li>
                    <li class="panel panel-default">
                        <div class="panel-heading" role="tab" id="sidebar-version-heading">
                            <h4 class="panel-title">
                                  Version: 1.46.0
                                </a>
                            </h4>
                        </div>
                    </li>
                <li class="panel panel-default">
                    <div class="panel-heading" role="tab" id="sidebar-modules-heading">
                        <h4 class="panel-title">
                    <a role="button" data-toggle="collapse" href="#sidebar-modules" aria-expanded="true" aria-controls="collapseOne">
                      Modules
                    </a>
                  </h4>
                    </div>
                    <div id="sidebar-modules" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="sidebar-modules-heading">
                        <div class="panel-body">
                                <ol>
                                        <li>
                                            <a href="../modules/Mappedin.html">Mappedin</a>
                                        </li>
                                </ol>
                        </div>
                    </div>
                </li>
            
                <li class="panel panel-default">
                    <div class="panel-heading" role="tab" id="sidebar-classes-heading">
                        <h4 class="panel-title">
                      <a role="button" data-toggle="collapse" href="#sidebar-classes" aria-expanded="true" aria-controls="collapseOne">
                        Classes
                      </a>
                    </h4>
                    </div>
                    <div id="sidebar-classes" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="sidebar-classes-heading">
                        <div class="panel-body">
                            <ol>
                                    <li>
                                        <a href="../classes/Analytics.html">Analytics</a>
                                    </li>
                                    <li>
                                        <a href="../classes/CameraControls.html">CameraControls</a>
                                    </li>
                                    <li>
                                        <a href="../classes/Easing.html">Easing</a>
                                    </li>
                                    <li>
                                        <a href="../classes/Mappedin.html">Mappedin</a>
                                    </li>
                                    <li>
                                        <a href="../classes/MappedinCategory.html">MappedinCategory</a>
                                    </li>
                                    <li>
                                        <a href="../classes/MappedinDirections.html">MappedinDirections</a>
                                    </li>
                                    <li>
                                        <a href="../classes/MappedinDirective.html">MappedinDirective</a>
                                    </li>
                                    <li>
                                        <a href="../classes/MappedinEvent.html">MappedinEvent</a>
                                    </li>
                                    <li>
                                        <a href="../classes/MappedinLocation.html">MappedinLocation</a>
                                    </li>
                                    <li>
                                        <a href="../classes/MappedinLocationState.html">MappedinLocationState</a>
                                    </li>
                                    <li>
                                        <a href="../classes/MappedinMap.html">MappedinMap</a>
                                    </li>
                                    <li>
                                        <a href="../classes/MappedinMapGroup.html">MappedinMapGroup</a>
                                    </li>
                                    <li>
                                        <a href="../classes/MappedinNode.html">MappedinNode</a>
                                    </li>
                                    <li>
                                        <a href="../classes/MappedinPolygon.html">MappedinPolygon</a>
                                    </li>
                                    <li>
                                        <a href="../classes/MappedinVenue.html">MappedinVenue</a>
                                    </li>
                                    <li>
                                        <a href="../classes/MappedinVortex.html">MappedinVortex</a>
                                    </li>
                                    <li>
                                        <a href="../classes/MapView.html">MapView</a>
                                    </li>
                                    <li>
                                        <a href="../classes/MapView2D.html">MapView2D</a>
                                    </li>
                                    <li>
                                        <a href="../classes/MapView3D.html">MapView3D</a>
                                    </li>
                                    <li>
                                        <a href="../classes/Marker.html">Marker</a>
                                    </li>
                                    <li>
                                        <a href="../classes/Search.html">Search</a>
                                    </li>
                                    <li>
                                        <a href="../classes/TextLabel.html">TextLabel</a>
                                    </li>
                                    <li>
                                        <a href="../classes/Tween.html">Tween</a>
                                    </li>
                            </ol>
                        </div>
                    </div>
                </li>
            </ol>
            <div class="content-container">
                <div class="apidocs">
                    <div id="docs-main">
                        <div class="content">
<div class="page-header">
    <h1><i class="fa fa-file-code-o" aria-hidden="true"></i>  File</h1>
</div>

<div class="file">
    <pre class="prettyprint linenums">
/* global Promise */
/**
 * The base Mappedin module, that has references to all the other Mappedin objects you need.
 *
 * Start with Mappedin.initialize, which will get the data for a Venue from the Mappedin API, and set up a MapView, Search, and Analytics object for you.
 *
 * @module Mappedin
 * @main
 */
var Mappedin = {};

import &#x27;./source/Mappedin.css&#x27;;
import TWEEN from &#x27;@tweenjs/tween.js&#x27;;
import Search from &#x27;./source/Mappedin.Search.js&#x27;;
import Analytics from &#x27;./source/Mappedin.Analytics.js&#x27;;
import TestResults from &#x27;./source/Mappedin.3DTestResults.js&#x27;;
import MapView3D from &#x27;./source/Mappedin.MapView3D.js&#x27;;
import MapView2D from &#x27;./source/Mappedin.MapView2D.js&#x27;;
import { modes, forceTest, test3D, getVenue } from &#x27;./Mappedin-common.es&#x27;;

var TEST_KEY = &quot;mappedin3DTestSuccess&quot;;

Mappedin.MapView = function () {
	console.error(&quot;MapView must be set to 2D or 3D mode! Run Mappedin.test3D, force3D, or force2D first!&quot;);
};

/**
 * The easing curves you can use for any animation (path drawing, camera movement, etc.)
 * See [tween.js](http://tweenjs.github.io/tween.js/examples/03_graphs.html) for your options.
 *
 * @class Easing
 * @static
 */
Mappedin.Easing = TWEEN.Easing;

/**
 * The Tween class from [Tween.js](https://github.com/tweenjs/tween.js). Exposed so you can create your own custom tweens.
 *
 * @class Tween
 * @constructor
 */
Mappedin.Tween = TWEEN.Tween;
Mappedin.Search = Search;
Mappedin.Analytics = Analytics;
Mappedin.TestResults = TestResults;

/**
 * Contains the functions you need to start the {{#crossLink &quot;MapView&quot;}}{{/crossLink}}. Typically you will just use &#x60;Mappedin.{{#crossLink &quot;Mappedin/initialize:method&quot;}}{{/crossLink}}&#x60;, which does all this for you, but for special cases your flow should look like this:
  1. One of Mappedin.{{#crossLink &quot;Mappedin/test3D:method&quot;}}{{/crossLink}} (typical), .{{#crossLink &quot;Mappedin/forceTest:method&quot;}}{{/crossLink}}, .{{#crossLink &quot;Mappedin/force3D:method&quot;}}{{/crossLink}}, or .{{#crossLink &quot;Mappedin/force2D:method&quot;}}{{/crossLink}} to put the MapView into either 2D or 3D mode.
  2. Mappedin.init to download all of the data you need from the Mappedin API.
  3. new Mappedin.MapView, which will create the MapView and display the default {{#crossLink &quot;MappedinMap&quot;}}{{/crossLink}}.

 * Each of those functions has a callback which you should use to trigger the next step. Once you get the final callback from the MapView
 * constructor, you can hide any loading screen UI and do whatever you want.
 *
 * @class Mappedin
 * @static
 */

Mappedin.modes = modes;
var mode = null;

/**
 * Forces Mapview into 2D mode.
 *
 * @method force2D
 * @param callback {function} The function to call when the Mapview is finished loading.
 */
Mappedin.force2D = function (callback) {
	Mappedin.MapView = MapView2D;
	Mappedin.MapView2D = Mappedin.MapView;
	mode = Mappedin.modes[&quot;2D&quot;];
	if (callback &amp;&amp; (typeof callback === typeof Function)) callback();
};

/**
 * Forces Mapview into 3D mode.
 *
 * @method force3D
 * @param callback {function} The function to call when 3D mode is ready.
 */
Mappedin.force3D = function (callback) {
	Mappedin.MapView = MapView3D;
	Mappedin.MapView3D = Mappedin.MapView;
	mode = Mappedin.modes[&quot;3D&quot;];
	if (callback &amp;&amp; (typeof callback === typeof Function)) callback();
};

// Convenience method to load either 2D or 3D mapview
var loadMapViewByMode = function(do3D) {
	if (do3D) {
		Mappedin.force3D();
	} else {
		Mappedin.force2D();
	}
};

Mappedin.forceTest = (container, callback) =&gt; forceTest(container, callback, loadMapViewByMode);
Mappedin.test3D = (container, callback) =&gt; test3D(container, callback, loadMapViewByMode);
Mappedin.getVenue = (options, callback) =&gt; getVenue(options, mode, callback);

// Backwards compatiblity
Mappedin.init = Mappedin.getVenue;

/**
* This function will take a single options object combining all options for Mappedin.init and the MapView constructor, and the div the MapView should live in.
* It returns a Promise that will resolve with the MapView once the 3D test has been performed, the right MapView was loaded, the data has been retrieved from the Mappedin API, and
* the MapView has been created. It could also fail (mostly if the options you set for the Mappedin API are incorrect).
*
* This is a convenience function that lets you avoid chaining a bunch of callbacks, calling test3D/force2D/force3D then Mappedin.init then the MapView constructor.
*
* @method initialize
* @param options {Object} Takes an object combining all options from Mappedin.init, the MapView constructor, and the Search constructor. If you explictly want to set the 3D mode rather than run the test, it also accepts a &#x60;mode&#x60; property that can be any of Mappedin.{{#crossLink &quot;Mappedin/modes:property&quot;}}{{/crossLink}}.
*	@param options.venue {Object} Any options from Mappedin.{{#crossLink &quot;Mappedin/getVenue:method&quot;}}{{/crossLink}}.
*	@param options.mapview {Object} Any options from the {{#crossLink &quot;MapView&quot;}}{{/crossLink}} constructor.
*	@param options.search {Object} Any options from the {{#crossLink &quot;Search&quot;}}{{/crossLink}} constructor.
*	@param options.firstMapSelector {Function} If you would like to pick the first Map loaded, set this function. It gives you a {{#crossLink &quot;MappedinVenue&quot;}}{{/crossLink}} object, and expects a {{#crossLink &quot;MappedinMap&quot;}}{{/crossLink}} or Map Id to be returned. Return venue.defaultMap for the default behaviour. If you return an invalid Map, an error will be logged to the console and an arbitrary Map will be loaded.
* @param container {Div} The HTML element the Mapview will live in.
*/
Mappedin.initialize = function (options, container) {
	return new Promise(function (resolve, reject) {
		var analyticsOptions = options.analytics || {};
		analyticsOptions.key = options.venue.clientId;
		analyticsOptions.secret = options.venue.clientSecret;
		analyticsOptions.venue = options.venue.venue;
		var analytics = new Mappedin.Analytics(analyticsOptions);

		function handleInit(error, venue) {
			if (error) {
				reject(error);
			} else {
				var mappedinData = {};
				try {
					if (options.firstMapSelector) {
						options.mapview.firstMap = options.firstMapSelector(venue);
					}
				} catch (exception) {
					console.error(&quot;Failure in firstMapSelector! Loading default map instead.&quot;);
					console.error(exception);
				}
				mappedinData.mapview = new Mappedin.MapView(container, venue, options.mapview);
				mappedinData.venue = venue;

				if (options.search) {
					mappedinData.search = new Mappedin.Search({
						&quot;key&quot;: options.search.key,
						&quot;secret&quot;: options.search.secret,
						&quot;venue&quot;: venue.venue.slug,
						&quot;baseUrl&quot;: options.search.baseUrl
					});
				}

				mappedinData.analytics = analytics;
				resolve(mappedinData);
			}
		}

		// We have either a 2D or 3D map loaded
		function mapViewTypeLoaded() {
			Mappedin.getVenue(options.venue, handleInit);
		}

		function handleTest(results, pass, score) {
			/* Do analytics */
			console.info(&quot;Mappedin 3D Test &quot; + (pass ? &quot;passed&quot; : (&quot;failed: &quot; + results)) + &quot; (&quot; + score + &quot;)&quot;);
			analytics.mapViewLoaded(pass ? &#x27;3d&#x27; : &#x27;2d&#x27;, false, score, results);

			if (pass) {
				Mappedin.force3D(mapViewTypeLoaded);
			} else {
				Mappedin.force2D(mapViewTypeLoaded);
			}
		}

		if (options.mapview.mode == undefined || options.mode == Mappedin.modes[&quot;TEST&quot;]) {
			try {
				var localStorage = window.localStorage;
				var savedResults = localStorage.getItem(TEST_KEY);
				if (savedResults != null) {
					options.mapview.mode = savedResults == &quot;true&quot; ? Mappedin.modes[&quot;3D&quot;] :  Mappedin.modes[&quot;2D&quot;];
				}
			} catch (e) {
				options.mapview.mode = Mappedin.modes[&quot;TEST&quot;];
			}
		}

		switch (options.mapview.mode) {
			case Mappedin.modes[&quot;3D&quot;] :
				analytics.mapViewLoaded(&#x27;3d&#x27;, true, null, null);
				Mappedin.force3D(mapViewTypeLoaded);
				break;
			case Mappedin.modes[&quot;2D&quot;] :
				analytics.mapViewLoaded(&#x27;2d&#x27;, true, null, null);
				Mappedin.force2D(mapViewTypeLoaded);
				break;
			case Mappedin.modes[&quot;FORCE_TEST&quot;] :
				Mappedin.forceTest(container, handleTest);
				break;
			case Mappedin.modes[&quot;TEST&quot;] :
			default :
				Mappedin.test3D(container, handleTest);
				break;
		}
	});
};

export default Mappedin;

    </pre>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="../assets/vendor/prettify/prettify-min.js"></script>
    <script>prettyPrint();</script>
    <script src="../assets/vendor/jquery/jquery.min.js"></script>
    <script src="../assets/vendor/jquery-ui/jquery-ui.min.js"></script>
    <script src="../assets/vendor/bootstrap/js/bootstrap.js"></script>
    <script src="../assets/vendor/github-slugger/slugger.js"></script>
    <script src="../assets/js/yuidoc-bootstrap.js"></script>
</body>
</html>
